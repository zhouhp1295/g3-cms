(function(e){function t(t){for(var r,o,i=t[0],n=t[1],d=t[2],p=0,m=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);u&&u(t);while(m.length)m.shift()();return l.push.apply(l,d||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],r=!0,i=1;i<a.length;i++){var n=a[i];0!==s[n]&&(r=!1)}r&&(l.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},s={app:0},l=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/install/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],n=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var u=n;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"1ce7":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),s=a("5c96"),l=a.n(s),o=(a("0fae"),function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("img",{attrs:{src:a("8fd5")}}),t("h3",[e._v("欢迎使用 g3-cms")]),t("el-steps",{attrs:{active:e.activeStep,"align-center":""}},[t("el-step",{attrs:{title:"步骤1",description:"数据库设置"}}),t("el-step",{attrs:{title:"步骤2",description:"超级管理员设置"}}),t("el-step",{attrs:{title:"步骤3",description:"安装"}})],1),t("div",{staticClass:"form-body"},[t("div",{staticClass:"form-steps"},[1===e.activeStep?t("div",[t("el-form",{ref:"step1form",staticStyle:{"text-align":"left"},attrs:{model:e.form,"label-width":"120px",rules:e.step1rules}},[t("div",{staticClass:"form-step-title"},[e._v("数据库设置")]),t("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"数据库类型",prop:"databaseType",required:""}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.databaseType,callback:function(t){e.$set(e.form,"databaseType",t)},expression:"form.databaseType"}},e._l(e.databaseOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),"mysql"===e.form.databaseType||"postgres"===e.form.databaseType?t("div",[t("el-form-item",{attrs:{label:"数据库主机",prop:"databaseHost",required:""}},[t("el-input",{model:{value:e.form.databaseHost,callback:function(t){e.$set(e.form,"databaseHost",t)},expression:"form.databaseHost"}}),t("div",[e._v("示例: MySQL 127.0.0.1:3306, PostgreSQL 127.0.0.1:5432")])],1),t("el-form-item",{attrs:{label:"数据库用户",prop:"databaseUser",required:""}},[t("el-input",{model:{value:e.form.databaseUser,callback:function(t){e.$set(e.form,"databaseUser",t)},expression:"form.databaseUser"}})],1),t("el-form-item",{attrs:{label:"数据库密码",prop:"databasePwd",required:""}},[t("el-input",{model:{value:e.form.databasePwd,callback:function(t){e.$set(e.form,"databasePwd",t)},expression:"form.databasePwd"}})],1)],1):e._e(),t("el-form-item",{attrs:{label:"数据库名称",prop:"databaseName",required:""}},[t("el-input",{model:{value:e.form.databaseName,callback:function(t){e.$set(e.form,"databaseName",t)},expression:"form.databaseName"}})],1)],1)],1):e._e(),2===e.activeStep?t("div",[t("el-form",{ref:"step2form",attrs:{model:e.form,"label-width":"120px",rules:e.step2rules}},[t("div",{staticClass:"form-step-title"},[e._v("超级管理员设置")]),t("el-form-item",{attrs:{label:"账户",prop:"username",required:""}},[t("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password",required:""}},[t("el-input",{model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1)],1):e._e(),e.activeStep===e.maxStep?t("div"):e._e()]),t("div",{staticClass:"form-footer"},[1===e.activeStep?t("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"warn"},on:{click:e.handleTestConn}},[e._v("测试连接")]):e._e(),1!==e.activeStep?t("el-button",{attrs:{type:"primary"},on:{click:e.handlePre}},[e._v("上一步")]):e._e(),e.activeStep<e.maxStep-1?t("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步")]):e._e(),e.activeStep===e.maxStep-1?t("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("开始安装")]):e._e()],1)])],1)}),i=[],n=a("bc3a"),d=a.n(n);d.a.defaults.headers["Content-Type"]="application/json;charset=utf-8";const u=d.a.create({baseURL:"",timeout:1e4});var p={name:"App",components:{},data(){return{activeStep:1,maxStep:3,fullscreenLoading:!1,databaseOptions:[{label:"SQLite3",value:"sqlite3"},{label:"MySQL",value:"mysql"},{label:"PostgreSQL",value:"postgres"}],form:{databaseType:"sqlite3",databaseHost:void 0,databaseUser:void 0,databasePwd:void 0,databaseName:void 0,username:void 0,password:void 0,installDemo:!0},step1rules:{databaseType:[{required:!0,message:"请选择数据库类型",trigger:"blur"}],databaseHost:[{required:!0,message:"请输入数据库主机",trigger:"blur"}],databaseUser:[{required:!0,message:"请输入数据库用户",trigger:"blur"}],databasePwd:[{required:!0,message:"请输入数据库密码",trigger:"blur"}],databaseName:[{required:!0,message:"请输入数据库名称",trigger:"blur"}]},step2rules:{username:[{required:!0,message:"请输入管理员账户",trigger:"blur"},{min:4,max:20,message:"长度在 4 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入管理员账户",trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}]}}},methods:{handlePre(){this.activeStep--},handleNext(){1===this.activeStep?this.handleStep1FormSubmit(!0):this.activeStep++},handleStep1FormSubmit(e){this.$refs.step1form.validate(t=>{if(!t)return!1;this.fullscreenLoading=!0,u({url:"/api/common/testConn",method:"post",data:this.form}).then(t=>{200===t.data.code?e?this.activeStep++:this.$message({message:t.data.msg,type:"success"}):this.$message({message:t.data.msg,type:"error"}),this.fullscreenLoading=!1})})},handleStep2FormSubmit(){this.$refs.step2form.validate(e=>{if(!e)return!1;this.fullscreenLoading=!0,u({url:"/api/common/install",method:"post",data:this.form}).then(e=>{200===e.data.code?this.$alert("欢迎使用 g3-cms","提示",{confirmButtonText:"确定",callback:()=>{window.location.href="/backend/"}}):this.$message({message:e.data.msg,type:"error"}),this.fullscreenLoading=!1})})},handleSubmit(){this.handleStep2FormSubmit()},handleTestConn(){this.handleStep1FormSubmit(!1)}}},m=p,c=(a("5da9"),a("2877")),f=Object(c["a"])(m,o,i,!1,null,null,null),b=f.exports;r["default"].config.productionTip=!1,r["default"].use(l.a),new r["default"]({render:e=>e(b)}).$mount("#app")},"5da9":function(e,t,a){"use strict";a("1ce7")},"8fd5":function(e,t,a){e.exports=a.p+"static/img/logo.e7c490de.png"}});